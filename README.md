### Maintainability and linter status:
[![testLinter](https://github.com/Mikhail325/test-task-100sp/actions/workflows/testLinter.yml/badge.svg)](https://github.com/Mikhail325/test-task-100sp/actions/workflows/testLinter.yml)
<a href="https://codeclimate.com/github/Mikhail325/test-task-100sp/maintainability"><img src="https://api.codeclimate.com/v1/badges/06dbe3b43a600e25cb39/maintainability" /></a>

# Тестовое задание

## Задание:

В качестве тестового задания нужно распарсить содержимое страницы https://www.100sp.ru/vladivostok и записать данные в базу данных.

На главной странице есть разные типы предложений объединяющие покупки. Типы:
- Новинки
- Популярные
- Быстрая доставка
- Обратите внимание
- …

“Покупками” считаем блок с фото, описанием, ссылкой внутри блока с типом. Ниже есть фото по которому понятно, что надо спарсить. Ознакомьтесь с ним пожалуйста.

Необходимо  написать PHP код который при запуске будет скачивать данные с главной страницы 100сп и сохранять их в базу. Старое содержимое базы на момент парсинга надо удалить. Т.е. в базе должна быть всегда одна копия данных, последняя по счету.

В базе храним:
* Тип покупок
* Внутри типа
* Название покупки
* Ссылка на фото покупки
* Ссылка на саму покупку (всегда содержит в url фразу /purchase/)

### Дополнительное задание

В конфиг парсера добавить не один город, а три:
- https://www.100sp.ru/vladivostok
- https://www.100sp.ru/artem
- https://www.100sp.ru/ussuriysk

Т.е. парсить и хранить в БД надо данных с 3х разных городов. В базе данных, для записей должен быть указан признак города.

После реализации указать конкретный sql запросы с помощью которых можно выбрать по 5 свежих записей из каждого города который есть в БД.

## Минимальные требования
* Composer >= 2.2;
* PHP >= 8.1;
* GNU Make >= 4.3;
* PostgreSQL >= 14.8;

## Инструкции по установке

С клонируйте репозиторий с GitHub и перейдите в директорию проекта используя команды:
```
git clone https://github.com/Mikhail325/test-task-100sp.git
cd test-task-100sp
```
### Подключения БД к приложению

Заполните данные о БД в строку имеющий следующий формат:
{provider}://{user}:{password}@{host}:{port}/{db}
Выполните команду в терминале подставив получившуюся строку
```
export DATABASE_URL=postgresql://janedoe:mypassword@localhost:5432/mydb
```
Если отсувует переменая оккружения то заполните даные в файле config/database.ini

### Инструкции по установке и запуску

Для установки зависимостей используйте команду **make install**.
Для добавления других городов добавте в масив *cities* в файле bin/parsingPurchases.
Для запуска программы используйте команду **make start** результат работы будет хранится в базе данных в таблицах type_purchases, purchases.
Для измения выдачи результатов по городу замените значение переменой *citi* в файле bin/parsingPurchases.
